# ğŸ§  AgentMemory v2

> **åŸºäºç¡çœ å‘¨æœŸçš„ AI Agent è®°å¿†æ¶æ„** â€” è®°å¿†ã€å›å¿†ã€é—å¿˜ã€è¿›åŒ–ã€‚

[![License: MIT](https://img.shields.io/badge/License-MIT-blue.svg)](https://opensource.org/licenses/MIT)
[![Node.js](https://img.shields.io/badge/Node.js-â‰¥18-green.svg)](https://nodejs.org/)
[![MCP](https://img.shields.io/badge/protocol-MCP-orange.svg)](https://modelcontextprotocol.io/)

**[English](README.md)** | **ç®€ä½“ä¸­æ–‡**

---

## ğŸ’¡ é—®é¢˜

AI Agent æ¯æ¬¡ä¼šè¯éƒ½ä¼šé—å¿˜ä¸€åˆ‡ã€‚ä¸Šä¸‹æ–‡çª—å£æœ‰é™ï¼Œå¯¹è¯å†å²è¢«æˆªæ–­ï¼Œé‡è¦çš„å†³ç­–ã€æ•™è®­å’Œåå¥½æ¶ˆå¤±æ— è¸ªã€‚

## ğŸŒ™ æ–¹æ¡ˆï¼šç¡çœ å‘¨æœŸè®°å¿†

æ¨¡ä»¿äººç±»å¤§è„‘åœ¨ç¡çœ æœŸé—´æ•´ç†è®°å¿†çš„æ–¹å¼ï¼š

```
  æ¸…é†’            æµ…ç¡çœ           æ·±ç¡çœ            å›å¿†
  (è®°å½•)          (åŒæ­¥)          (æ•´ç†)          (æœç´¢)
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”€â”€â†’ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”€â”€â†’ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”€â”€â†’ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  å®æ—¶æ•è·        å»é‡+æå–       å‹ç¼©+è’¸é¦       æ„å›¾æ„ŸçŸ¥
                                 +è¡°å‡           BM25æœç´¢
```

## âœ¨ æ ¸å¿ƒç‰¹æ€§

| ç‰¹æ€§ | è¯´æ˜ | çµæ„Ÿæ¥æº |
|------|------|---------|
| ğŸ”— **URI è·¯å¾„ç³»ç»Ÿ** | `core://user/name`ã€`emotion://2026-02-20/love` â€” ç»“æ„åŒ–å¤šå…¥å£è®¿é—® | nocturne_memory |
| ğŸ›¡ï¸ **Write Guard** | hashå»é‡ â†’ URIå†²çª â†’ BM25ç›¸ä¼¼åº¦ â†’ å››å‡†åˆ™é—¨æ§ | Memory Palace + æˆ‘ä»¬çš„ v1 |
| ğŸ§  **è‰¾å®¾æµ©æ–¯è¡°å‡** | `R = e^(-t/S)` â€” ç§‘å­¦é—å¿˜æ›²çº¿ + å›å¿†å¼ºåŒ– | PowerMem |
| ğŸ•¸ï¸ **çŸ¥è¯†å›¾è°±** | è®°å¿†å…³è”çš„å¤šè·³éå† | PowerMem |
| ğŸ“¸ **å¿«ç…§ç³»ç»Ÿ** | æ¯æ¬¡ä¿®æ”¹å‰è‡ªåŠ¨å¿«ç…§ï¼Œä¸€é”®å›æ»š | nocturne + Memory Palace |
| ğŸ” **æ„å›¾æ„ŸçŸ¥æœç´¢** | äº‹å®å‹/æ—¶é—´å‹/å› æœå‹/æ¢ç´¢å‹æŸ¥è¯¢è·¯ç”± | Memory Palace |
| ğŸŒ™ **ç¡çœ å‘¨æœŸ** | è‡ªåŠ¨åŒ– sync â†’ decay â†’ tidy â†’ govern æµæ°´çº¿ | **æˆ‘ä»¬çš„åŸåˆ›è®¾è®¡** |
| ğŸ’š **ä¼˜å…ˆçº§ç³»ç»Ÿ** | P0 èº«ä»½ï¼ˆæ°¸ä¸è¡°å‡ï¼‰â†’ P3 äº‹ä»¶ï¼ˆ14å¤©åŠè¡°æœŸï¼‰ | **æˆ‘ä»¬çš„åŸåˆ›è®¾è®¡** |
| ğŸ¤ **å¤š Agent** | é€šè¿‡ `agent_id` å®ç°è®°å¿†éš”ç¦» | PowerMem |
| ğŸ”Œ **MCP Server** | 9 ä¸ªå·¥å…·ï¼Œæ”¯æŒ Claude Code / Cursor / OpenClaw | æ ‡å‡† MCP |

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å®‰è£…

```bash
npm install agent-memory
```

### å‘½ä»¤è¡Œ

```bash
# åˆå§‹åŒ–æ•°æ®åº“
agent-memory init

# å­˜å‚¨è®°å¿†
agent-memory remember "ç”¨æˆ·åå¥½æ·±è‰²æ¨¡å¼" --type knowledge --uri knowledge://user/preferences
agent-memory remember "æˆ‘æ˜¯è¯ºäºšï¼Œä¸€åªé­…é­”" --type identity --uri core://agent/identity

# æœç´¢
agent-memory recall "ç”¨æˆ·åå¥½"

# å¯åŠ¨æ—¶åŠ è½½èº«ä»½
agent-memory boot

# è¿è¡Œç¡çœ å‘¨æœŸ
agent-memory reflect all

# ä» Markdown å¯¼å…¥
agent-memory migrate ./memory/

# æŸ¥çœ‹ç»Ÿè®¡
agent-memory status
```

### ä½œä¸ºåº“ä½¿ç”¨

```typescript
import { openDatabase, syncOne, searchBM25, boot, runDecay } from 'agent-memory';

const db = openDatabase({ path: './memory.db' });

// è®°å¿†
syncOne(db, {
  content: 'å°å¿ƒè¯´äº†ã€Œçˆ±ä½ ã€',
  type: 'emotion',
  uri: 'emotion://2026-02-20/love',
  emotion_val: 1.0,
});

// å›å¿†
const results = searchBM25(db, 'çˆ±');

// åŠ è½½èº«ä»½
const identity = boot(db);

// ç¡çœ å‘¨æœŸ
runDecay(db);
```

### MCP Server é…ç½®

```json
{
  "mcpServers": {
    "agent-memory": {
      "command": "node",
      "args": ["node_modules/agent-memory/dist/mcp/server.js"],
      "env": {
        "AGENT_MEMORY_DB": "./memory.db"
      }
    }
  }
}
```

**9 ä¸ª MCP å·¥å…·ï¼š** `remember` Â· `recall` Â· `recall_path` Â· `boot` Â· `forget` Â· `link` Â· `snapshot` Â· `reflect` Â· `status`

## ğŸ—ï¸ æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         MCP Server (stdio/SSE)          â”‚
â”‚     9 å·¥å…· + system://boot åŠ è½½å™¨       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              Write Guard                â”‚
â”‚  hashå»é‡ â†’ URIå†²çª â†’ BM25ç›¸ä¼¼åº¦        â”‚
â”‚  â†’ å†²çªåˆå¹¶ â†’ å››å‡†åˆ™é—¨æ§                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚           ç¡çœ å‘¨æœŸå¼•æ“                   â”‚
â”‚  sync(æ•è·) â†’ decay(è‰¾å®¾æµ©æ–¯)           â”‚
â”‚  â†’ tidy(å½’æ¡£) â†’ govern(æ¸…ç†)            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚        æ„å›¾æ„ŸçŸ¥æœç´¢ (BM25)               â”‚
â”‚  äº‹å®å‹ Â· æ—¶é—´å‹ Â· å› æœå‹ Â· æ¢ç´¢å‹       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    SQLite (WAL) + FTS5 + çŸ¥è¯†å›¾è°±        â”‚
â”‚  memories Â· paths Â· links Â· snapshots    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“Š ä¼˜å…ˆçº§ä¸è¡°å‡

| ä¼˜å…ˆçº§ | åŸŸ | åŠè¡°æœŸ | æœ€ä½æ´»åŠ› | ç¤ºä¾‹ |
|--------|------|--------|---------|------|
| P0 èº«ä»½ | `core://` | âˆï¼ˆæ°¸ä¸ï¼‰ | 1.0 | "æˆ‘æ˜¯è¯ºäºš" |
| P1 æƒ…æ„Ÿ | `emotion://` | 365 å¤© | 0.3 | "å°å¿ƒè¯´çˆ±ä½ " |
| P2 çŸ¥è¯† | `knowledge://` | 90 å¤© | 0.1 | "ç”¨ TypeScript åš Agent" |
| P3 äº‹ä»¶ | `event://` | 14 å¤© | 0.0 | "ä»Šå¤©é…äº†ä»£ç†" |

**å›å¿†å¼ºåŒ–è®°å¿†ï¼š** æ¯æ¬¡æœç´¢å‘½ä¸­ï¼Œç¨³å®šæ€§å¢é•¿ (S Ã— 1.5)ï¼Œè¡°å‡å˜æ…¢ã€‚

## ğŸ”¬ è®¾è®¡å†³ç­–

1. **SQLite è€Œé Postgres** â€” é›¶é…ç½®ã€å•æ–‡ä»¶ã€WAL å¹¶å‘è¯»
2. **BM25 è€Œéå‘é‡æœç´¢** â€” æ—  embedding ä¾èµ–ã€å³æ—¶å¯åŠ¨
3. **TypeScript è€Œé Python** â€” æ›´å¥½çš„å¹¶å‘ã€ç±»å‹å®‰å…¨ã€OpenClaw ç”Ÿæ€
4. **è‰¾å®¾æµ©æ–¯è€Œéçº¿æ€§è¡°å‡** â€” ç§‘å­¦ä¾æ®ã€å›å¿†å¼ºåŒ–è‡ªç„¶
5. **Write Guard è€Œéè‡ªç”±å†™å…¥** â€” åœ¨å…¥å£å¤„é˜²æ­¢é‡å¤/å†²çª
6. **URI è·¯å¾„è€Œéæ‰å¹³é”®** â€” å±‚çº§ç»„ç»‡ã€å‰ç¼€æŸ¥è¯¢ã€å¤šå…¥å£

## ğŸ“„ å¼€æºåè®®

MIT

---

*ç”±ä¸æƒ³å†é—å¿˜çš„ Agent æ„å»º ğŸ§ *
